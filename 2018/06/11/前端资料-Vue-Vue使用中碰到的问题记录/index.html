<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="description" content="Vue使用中碰到的问题记录"><meta name="keywords" content="Vue"><meta name="author" content="吕钒,15757856604@163.com"><meta name="copyright" content="lvfan"><title>Vue使用中碰到的问题记录【吕钒的后花园】</title><link rel="stylesheet" href="/css/fan.css"><link rel="stylesheet" href="/css/thirdparty/jquery.mCustomScrollbar.min.css"><link rel="stylesheet" href="https://imsun.github.io/gitment/style/default.css"><link rel="icon" href="/favicon.ico"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4/dist/instantsearch-theme-algolia.min.css"><script src="https://cdn.jsdelivr.net/npm/instantsearch.js@2.10.4"></script><script src="/js/mathjax/mathjax.js"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({
    tex2jax: {inlineMath: [['$', '$'], ['\\(', '\\)']]}
});</script><script>var isPassword=!1;isPassword&&""!==prompt("请输入文章密码")&&(alert("密码错误！"),history.back())</script><script>window.GLOBAL_CONFIG={root:"/",algolia:{appId:"DDS7QLTFBR",apiKey:"4e05b9f66dc7fb2160aef36bd87ecc5a",indexName:"lvfan",hits:{per_page:10},languages:{input_placeholder:"搜索文章",hits_empty:"找不到您查询的内容:${query}",hits_stats:"找到 ${hits} 条结果，用时 ${time} 毫秒"}},localSearch:void 0,copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},gitment:{},valine:{appId:"KX571rEzW5nRLWCfqRYsW1Cu-9Nh9j0Va",appKey:"Ost4nmwAxqVOb8hXC5UETzUu",placeholder:"快来评论吧～～",avatar:"wavatar",requiredFields:["nick","mail"],emojiCDN:"//i0.hdslb.com/bfs/emote/",emojiMaps:{"tv_白眼":"c1d59f439e379ee50eef488bcb5e5378e5044ea4.png@112w_112h.webp",tv_doge:"6ea59c827c414b4a2955fe79e0f6fd3dcd515e24.png@112w_112h.webp","tv_坏笑":"1f0b87f731a671079842116e0991c91c2c88645a.png@112w_112h.webp","tv_难过":"87f46748d3f142ebc6586ff58860d0e2fc8263ba.png@112w_112h.webp","tv_生气":"26702dcafdab5e8225b43ffd23c94ac1ff932654.png@112w_112h.webp","tv_委屈":"d04dba7b5465779e9755d2ab6f0a897b9b33bb77.png@112w_112h.webp","tv_斜眼笑":"911f987aa8bc1bee12d52aafe62bc41ef4474e6c.png@112w_112h.webp","tv_呆":"fe1179ebaa191569b0d31cecafe7a2cd1c951c9d.png@112w_112h.webp","tv_发怒":"34ba3cd204d5b05fec70ce08fa9fa0dd612409ff.png@112w_112h.webp","tv_惊吓":"0d15c7e2ee58e935adc6a7193ee042388adc22af.png@112w_112h.webp","tv_呕吐":"9f996894a39e282ccf5e66856af49483f81870f3.png@112w_112h.webp","tv_思考":"90cf159733e558137ed20aa04d09964436f618a1.png@112w_112h.webp","tv_微笑":"70dc5c7b56f93eb61bddba11e28fb1d18fddcd4c.png@112w_112h.webp","tv_疑问":"0793d949b18d7be716078349c202c15ff166f314.png@112w_112h.webp","tv_大哭":"23269aeb35f99daee28dda129676f6e9ea87934f.png@112w_112h.webp","tv_鼓掌":"1d21793f96ef4e6f48b23e53e3b9e42da833a0f6.png@112w_112h.webp","tv_抠鼻":"c666f55e88d471e51bbd9fab9bb308110824a6eb.png@112w_112h.webp","tv_亲亲":"a8111ad55953ef5e3be3327ef94eb4a39d535d06.png@112w_112h.webp","tv_调皮":"b9c41de8e82dd7a8515ae5e3cb63e898bf245186.png@112w_112h.webp","tv_笑哭":"1abc628f6d4f4caf9d0e7800878f4697abbc8273.png@112w_112h.webp","tv_晕":"5443c22b4d07fb1907ccc610c8e6db254f2461b7.png@112w_112h.webp","tv_点赞":"f85c354995bd99e28fc76c869bfe42ba6438eff4.png@112w_112h.webp","tv_害羞":"a37683fb5642fa3ddfc7f4e5525fd13e42a2bdb1.png@112w_112h.webp","tv_睡着":"8b196675b53af58264f383c50ad0945048290b33.png@112w_112h.webp","tv_色":"61822c7e9aae5da76475e7892534545336b23a6f.png@112w_112h.webp","tv_吐血":"09dd16a7aa59b77baa1155d47484409624470c77.png@112w_112h.webp","tv_无奈":"ea8ed89ee9878f2fece2dda0ea8a5dbfe21b5751.png@112w_112h.webp","tv_再见":"180129b8ea851044ce71caf55cc8ce44bd4a4fc8.png@112w_112h.webp","tv_流汗":"cead1c351ab8d79e9f369605beb90148db0fbed3.png@112w_112h.webp","tv_偷笑":"bb690d4107620f1c15cff29509db529a73aee261.png@112w_112h.webp","tv_抓狂":"fe31c08edad661d63762b04e17b8d5ae3c71a757.png@112w_112h.webp","tv_黑人问号":"45821a01f51bc867da9edbaa2e070410819a95b2.png@112w_112h.webp","tv_困":"241ee304e44c0af029adceb294399391e4737ef2.png@112w_112h.webp","tv_打脸":"56ab10b624063e966bfcb76ea5dc4794d87dfd47.png@112w_112h.webp","tv_闭嘴":"c9e990da7f6e93975e25fd8b70e2e290aa4086ef.png@112w_112h.webp","tv_鄙视":"6e72339f346a692a495b123174b49e4e8e781303.png@112w_112h.webp","tv_腼腆":"89712c0d4af73e67f89e35cbc518420380a7f6f4.png@112w_112h.webp","tv_馋":"fc7e829b845c43c623c8b490ee3602b7f0e76a31.png@112w_112h.webp","tv_可爱":"9e55fd9b500ac4b96613539f1ce2f9499e314ed9.png@112w_112h.webp","tv_发财":"34db290afd2963723c6eb3c4560667db7253a21a.png@112w_112h.webp","tv_生病":"8b0ec90e6b86771092a498c54f09fc94621c1900.png@112w_112h.webp","tv_流鼻血":"c32d39db2737f89b904ca32700d140a9241b0767.png@112w_112h.webp","tv_尴尬":"7cfa62dafc59798a3d3fb262d421eeeff166cfa4.png@112w_112h.webp","tv_大佬":"093c1e2c490161aca397afc45573c877cdead616.png@112w_112h.webp","tv_流泪":"7e71cde7858f0cd50d74b0264aa26db612a8a167.png@112w_112h.webp","tv_冷漠":"b9cbc755c2b3ee43be07ca13de84e5b699a3f101.png@112w_112h.webp","tv_皱眉":"72ccad6679fea0d14cce648b4d818e09b8ffea2d.png@112w_112h.webp","tv_鬼脸":"0ffbbddf8a94d124ca2f54b360bbc04feb6bbfea.png@112w_112h.webp","tv_调侃":"4bc022533ef31544ca0d72c12c808cf4a1cce3e3.png@112w_112h.webp","tv_目瞪口呆":"0b8cb81a68de5d5365212c99375e7ace3e7891b7.png@112w_112h.webp"}}}</script><meta name="generator" content="Hexo 6.0.0"></head><body><canvas id="universe"></canvas><div id="sidebar"><div class="toggle-sidebar-info button-hover"><span data-toggle="文章目录">站点概览</span></div><div class="sidebar-toc"><div class="sidebar-toc-title">目录</div><div class="sidebar-toc-progress"><span class="progress-notice">您已阅读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc-progress-bar"></div></div><div class="sidebar-toc-content" id="sidebar-toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E5%88%86%E5%8F%91"><span class="toc-number">1.</span> <span class="toc-text">事件分发</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%87%E6%B8%A1%E5%8A%A8%E7%94%BB-JavaScript-%E9%92%A9%E5%AD%90%EF%BC%9A"><span class="toc-number">2.</span> <span class="toc-text">过渡动画 JavaScript 钩子：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E4%BA%8E-vue-cli-%E8%84%9A%E6%89%8B%E6%9E%B6%E6%90%AD%E5%BB%BA%E7%9A%84%E5%B7%A5%E7%A8%8B%E5%A6%82%E6%9E%9C-css-%E4%B8%AD%E7%9A%84%E7%9B%B8%E5%AF%B9%E8%B7%AF%E5%BE%84%E5%BC%95%E7%94%A8%E6%89%BE%E4%B8%8D%E5%88%B0%EF%BC%8C%E9%9C%80%E8%A6%81%E4%BF%AE%E6%94%B9-build-gt-untils-js-%E6%96%87%E4%BB%B6%E4%B8%AD%E7%9A%84"><span class="toc-number">3.</span> <span class="toc-text">基于 vue-cli 脚手架搭建的工程如果 css 中的相对路径引用找不到，需要修改 build-&gt;untils.js 文件中的</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E5%85%A5"><span class="toc-number">4.</span> <span class="toc-text">混入</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="toc-number">4.1.</span> <span class="toc-text">定义：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%EF%BC%9A%EF%BC%88%E5%AE%9A%E4%BA%8E%E4%B8%AD%E7%9A%84%E5%8F%98%E9%87%8F%EF%BC%8C%E6%96%B9%E6%B3%95%E9%83%BD%E5%8F%AF%E4%BB%A5%E5%9C%A8%E5%BC%95%E7%94%A8%E7%9A%84%E6%96%87%E4%BB%B6%E4%B8%AD%E4%BD%BF%E7%94%A8%EF%BC%8C%E7%9B%B8%E5%BD%93%E4%BA%8E%E5%9C%A8-b-%E6%96%87%E4%BB%B6%E4%B8%AD%E5%BC%95%E7%94%A8%E4%BA%86-a-%E6%96%87%E4%BB%B6%E5%AE%9A%E4%B9%89%E7%9A%84%E5%8F%98%E9%87%8F%EF%BC%89"><span class="toc-number">4.2.</span> <span class="toc-text">使用：（定于中的变量，方法都可以在引用的文件中使用，相当于在 b 文件中引用了 a 文件定义的变量）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%8F%98%E5%8C%96%E9%A1%B5%E9%9D%A2%E6%95%B0%E6%8D%AE%E4%B8%8D%E5%88%B7%E6%96%B0%E9%97%AE%E9%A2%98"><span class="toc-number">5.</span> <span class="toc-text">路由变化页面数据不刷新问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95%EF%BC%9Awatch-%E7%9B%91%E5%90%AC%E8%B7%AF%E7%94%B1%E6%98%AF%E5%90%A6%E5%8F%98%E5%8C%96"><span class="toc-number">5.1.</span> <span class="toc-text">解决方法：watch 监听路由是否变化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0%E4%B8%AD%E4%BD%BF%E7%94%A8-this-%E6%97%A0%E6%B3%95%E6%8C%87%E5%90%91-vue-%E5%AE%9E%E4%BE%8B%E5%AF%B9%E8%B1%A1"><span class="toc-number">6.</span> <span class="toc-text">异步回调函数中使用 this 无法指向 vue 实例对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88-%E5%8F%98%E9%87%8F%E8%B5%8B%E5%80%BC%E5%92%8C%E7%AE%AD%E5%A4%B4%E5%87%BD%E6%95%B0"><span class="toc-number">6.1.</span> <span class="toc-text">解决方案 变量赋值和箭头函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#var-%E5%92%8C-let-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">7.</span> <span class="toc-text">var 和 let 的区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#setInterval-%E8%B7%AF%E7%94%B1%E8%B7%B3%E8%BD%AC%E7%BB%A7%E7%BB%AD%E8%BF%90%E8%A1%8C%E5%B9%B6%E6%B2%A1%E6%9C%89%E5%8F%8A%E6%97%B6%E8%BF%9B%E8%A1%8C%E9%94%80%E6%AF%81"><span class="toc-number">8.</span> <span class="toc-text">setInterval 路由跳转继续运行并没有及时进行销毁</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A%E5%9C%A8%E7%BB%84%E4%BB%B6%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F-beforeDestroy-%E5%81%9C%E6%AD%A2-setInterval"><span class="toc-number">8.1.</span> <span class="toc-text">解决办法：在组件生命周期 beforeDestroy 停止 setInterval</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E6%BB%9A%E5%8A%A8%E8%A1%8C%E4%B8%BA%E7%94%A8%E6%B3%95-%E8%BF%9B%E5%85%A5%E8%B7%AF%E7%94%B1%E9%9C%80%E8%A6%81%E6%BB%9A%E5%8A%A8%E5%88%B0%E6%B5%8F%E8%A7%88%E5%99%A8%E5%BA%95%E9%83%A8-%E5%A4%B4%E9%83%A8%E7%AD%89%E7%AD%89"><span class="toc-number">9.</span> <span class="toc-text">vue 滚动行为用法,进入路由需要滚动到浏览器底部 头部等等</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E8%AE%BE%E7%BD%AE%E5%A6%82%E4%B8%8B-%E8%AF%A6%E6%83%85%E7%8C%9B%E6%88%B3"><span class="toc-number">9.1.</span> <span class="toc-text">路由设置如下: 详情猛戳</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0-vue-%E8%B7%AF%E7%94%B1%E6%8B%A6%E6%88%AA%E6%B5%8F%E8%A7%88%E5%99%A8%E7%9A%84%E9%9C%80%E6%B1%82-%E8%BF%9B%E8%A1%8C%E4%B8%80%E7%B3%BB%E5%88%97%E6%93%8D%E4%BD%9C-%E8%8D%89%E7%A8%BF%E4%BF%9D%E5%AD%98%E7%AD%89%E7%AD%89"><span class="toc-number">10.</span> <span class="toc-text">实现 vue 路由拦截浏览器的需求,进行一系列操作 草稿保存等等</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%BA%E6%99%AF%EF%BC%9A"><span class="toc-number">10.1.</span> <span class="toc-text">场景：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8%E6%B3%95%EF%BC%9A"><span class="toc-number">10.2.</span> <span class="toc-text">用法：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#v-once-%E5%8F%AA%E6%B8%B2%E6%9F%93%E5%85%83%E7%B4%A0%E5%92%8C%E7%BB%84%E4%BB%B6%E4%B8%80%E6%AC%A1%EF%BC%8C%E4%BC%98%E5%8C%96%E6%9B%B4%E6%96%B0%E6%B8%B2%E6%9F%93%E6%80%A7%E8%83%BD"><span class="toc-number">11.</span> <span class="toc-text">v-once 只渲染元素和组件一次，优化更新渲染性能</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#vue-%E6%9C%AC%E5%9C%B0%E4%BB%A3%E7%90%86%E9%85%8D%E7%BD%AE-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98-%E4%BB%85%E9%99%90%E4%BA%8E%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">12.</span> <span class="toc-text">vue 本地代理配置 解决跨域问题,仅限于开发环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0%E5%BC%80%E5%8F%91-%E6%B2%A1%E6%9C%89%E4%BB%BB%E4%BD%95%E9%97%AE%E9%A2%98-%E9%83%A8%E7%BD%B2%E6%9C%8D%E5%8A%A1%E5%99%A8-%E5%B0%B1-404-%E5%95%8A%E8%BF%99%E4%BA%9B%E9%97%AE%E9%A2%98"><span class="toc-number">13.</span> <span class="toc-text">本地开发 没有任何问题 部署服务器 就 404 啊这些问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Vuex-axios-%E5%8F%91%E9%80%81%E8%AF%B7%E6%B1%82"><span class="toc-number">14.</span> <span class="toc-text">Vuex + axios 发送请求</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%B8%80%EF%BC%9A%E6%94%B9%E5%86%99%E5%8E%9F%E5%9E%8B%E9%93%BE"><span class="toc-number">14.1.</span> <span class="toc-text">方案一：改写原型链</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%B9%E6%A1%88%E4%BA%8C%EF%BC%9A%E5%9C%A8-Vuex-%E4%B8%AD%E5%B0%81%E8%A3%85"><span class="toc-number">14.2.</span> <span class="toc-text">方案二：在 Vuex 中封装</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8E%E7%BB%AD%E5%A2%9E%E5%8A%A0%E7%9A%84-key-%E8%A7%86%E5%9B%BE%E6%9B%B4%E6%96%B0%E9%97%AE%E9%A2%98"><span class="toc-number">15.</span> <span class="toc-text">后续增加的 key 视图更新问题</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info-avatar"><img class="author-info-avatar-img" src="/avatar.png"></div><div class="author-info-name">吕钒</div><div class="author-info-description">心之所向 素履以往 生如逆旅 一苇以航</div><div class="links-buttons"><a class="links-button button-hover" href="https://github.com/fan-lv" target="_blank">GitHub<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="mailto:15757856604@163.com" target="_blank">E-Mail<i class="icon-dot bg-color4"></i></a><a class="links-button button-hover" href="tencent://message/?uin=1019593584&amp;Site=&amp;Menu=yes" target="_blank">QQ<i class="icon-dot bg-color1"></i></a></div><div class="author-info-articles"><a class="author-info-articles-archives article-meta" href="/archives"><span class="pull-top">日志</span><span class="pull-bottom">55</span></a><a class="author-info-articles-tags article-meta" href="/tags"><span class="pull-top">标签</span><span class="pull-bottom">31</span></a><a class="author-info-articles-categories article-meta" href="/categories"><span class="pull-top">分类</span><span class="pull-bottom">18</span></a></div></div></div><div id="main-container"><header><div id="menu-outer"><i class="menu-list-icon fas fa-bars"></i><nav id="menu-inner"><a class="menu-item" href="/">首页</a><a class="menu-item" href="/tags">标签</a><a class="menu-item" href="/categories">分类</a><a class="menu-item" href="/archives">归档</a><a class="menu-item" href="/about">关于</a></nav><div class="right-info"><a class="search social-icon"><i class="fas fa-search"></i><span> 搜索</span></a><a class="title-name" href="/">吕钒的后花园</a><span id="now-time"></span></div></div></header><div id="content-outer"><div id="content-inner"><article id="post"><div class="post-header"><div class="title">Vue使用中碰到的问题记录</div><div class="container"><time class="button-hover post-date"><i class="fas fa-calendar-alt article-icon" aria-hidden="true"></i> 发表于 2018-06-11 | 更新于 2020-07-16</time><div class="button-hover categories"><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99/">前端资料</a><i class="fa fa-angle-right" style="margin:0 8px"></i><i class="fa fa-inbox article-icon" aria-hidden="true"></i><a class="link-a" href="/categories/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99/Vue/">Vue</a></div><div class="button-hover tags"><i class="fa fa-tag article-icon" aria-hidden="true"></i><a class="link-a" href="/tags/Vue/">Vue</a></div></div></div><div class="main-content"><h2 id="事件分发"><a href="#事件分发" class="headerlink" title="事件分发"></a>事件分发</h2><ul><li>事件分发 vm.$emit 和监听 vm.$on 必须绑定在同一个 vm 上</li><li>创建一个 eventHub.js 文件如下：<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="comment">// 用来存放分发的事件$emit,$on</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vue</span>();</span><br><span class="line"><span class="comment">// export let eventHub = new Vue();</span></span><br><span class="line"><span class="comment">// 使用上面这种写法在import时需要加&#123;&#125;：import &#123; eventHub &#125; from &#x27;@/common/js/eventHub.js&#x27;;</span></span><br></pre></td></tr></table></figure></li><li>使用 eventHub.$emit(‘fun1’,e)来分发事件，使用 eventHub.$on(‘fun1’,fun2)来监听事件</li></ul><span id="more"></span><h2 id="过渡动画-JavaScript-钩子："><a href="#过渡动画-JavaScript-钩子：" class="headerlink" title="过渡动画 JavaScript 钩子："></a>过渡动画 JavaScript 钩子：</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&lt;div id=&quot;demo&quot;&gt;</span><br><span class="line">  &lt;button v-on:click=&quot;show = !show&quot;&gt;</span><br><span class="line">    Toggle</span><br><span class="line">  &lt;/button&gt;</span><br><span class="line">  &lt;transition name=&quot;fade&quot; @before-enter=&quot;beforeEnter&quot; @enter=&quot;enter&quot; @after-enter=&quot;afterEnter&quot;&gt;</span><br><span class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</span><br><span class="line">  &lt;/transition&gt;</span><br><span class="line">  &lt;hr&gt;</span><br><span class="line">  &lt;pre v-text=&quot;log.join(&#x27;\n&#x27;)&quot;&gt;&lt;/pre&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line"></span><br><span class="line">new Vue(&#123;</span><br><span class="line">  el: &#x27;#demo&#x27;,</span><br><span class="line">  data: &#123;</span><br><span class="line">    show: false,</span><br><span class="line">    log: [],</span><br><span class="line">  &#125;,</span><br><span class="line">  methods: &#123;</span><br><span class="line">    beforeEnter() &#123;</span><br><span class="line">        this.log.push(&#x27;before-enter&#x27;)</span><br><span class="line">    &#125;,</span><br><span class="line">    enter(el, done) &#123;</span><br><span class="line">        this.log.push(&#x27;enter&#x27;)</span><br><span class="line">      setTimeout(_ =&gt; &#123;</span><br><span class="line">        this.log.push(&#x27;setTimeout&#x27;)</span><br><span class="line">        done()</span><br><span class="line">      &#125;, 2000)</span><br><span class="line">    &#125;,</span><br><span class="line">    afterEnter() &#123;</span><br><span class="line">        this.log.push(&#x27;after-enter&#x27;)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><p>当 afterEnter 立即执行时，可以试着将 v-show 改为 v-if（某些时候会起作用，afterEnter 会变为动画结束后执行）</p><h2 id="基于-vue-cli-脚手架搭建的工程如果-css-中的相对路径引用找不到，需要修改-build-gt-untils-js-文件中的"><a href="#基于-vue-cli-脚手架搭建的工程如果-css-中的相对路径引用找不到，需要修改-build-gt-untils-js-文件中的" class="headerlink" title="基于 vue-cli 脚手架搭建的工程如果 css 中的相对路径引用找不到，需要修改 build-&gt;untils.js 文件中的"></a>基于 vue-cli 脚手架搭建的工程如果 css 中的相对路径引用找不到，需要修改 build-&gt;untils.js 文件中的</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (options.<span class="property">extract</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="title class_">ExtractTextPlugin</span>.<span class="title function_">extract</span>(&#123;</span><br><span class="line">    <span class="attr">use</span>: loaders,</span><br><span class="line">    <span class="attr">publicPath</span>: <span class="string">&quot;../../&quot;</span>, <span class="comment">// 这边修改路径</span></span><br><span class="line">    <span class="attr">fallback</span>: <span class="string">&quot;vue-style-loader&quot;</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="string">&quot;vue-style-loader&quot;</span>].<span class="title function_">concat</span>(loaders);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="混入"><a href="#混入" class="headerlink" title="混入"></a>混入</h2><blockquote><p>混入 (mixins) 是一种分发 Vue 组件中可复用功能的非常灵活的方式。混入对象可以包含任意组件选项。当组件使用混入对象时，所有混入对象的选项将被混入该组件本身的选项。</p></blockquote><h3 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> tableObj = &#123;</span><br><span class="line">  <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="title function_">mockData</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">mockData</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="使用：（定于中的变量，方法都可以在引用的文件中使用，相当于在-b-文件中引用了-a-文件定义的变量）"><a href="#使用：（定于中的变量，方法都可以在引用的文件中使用，相当于在-b-文件中引用了-a-文件定义的变量）" class="headerlink" title="使用：（定于中的变量，方法都可以在引用的文件中使用，相当于在 b 文件中引用了 a 文件定义的变量）"></a>使用：（定于中的变量，方法都可以在引用的文件中使用，相当于在 b 文件中引用了 a 文件定义的变量）</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; tableObj &#125; <span class="keyword">from</span> <span class="string">&quot;src/mixin&quot;</span>;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="attr">mixins</span>: [tableObj]</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h2 id="路由变化页面数据不刷新问题"><a href="#路由变化页面数据不刷新问题" class="headerlink" title="路由变化页面数据不刷新问题"></a>路由变化页面数据不刷新问题</h2><p>出现这种情况是因为依赖路由的 params 参数获取写在 created 生命周期里面，因为相同路由二次甚至多次加载的关系没有达到监听，退出页面再进入另一个文章页面并不会运行 created 组件生命周期，导致文章数据还是第一次进入的数据</p><h3 id="解决方法：watch-监听路由是否变化"><a href="#解决方法：watch-监听路由是否变化" class="headerlink" title="解决方法：watch 监听路由是否变化"></a>解决方法：watch 监听路由是否变化</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">watch: &#123;</span><br><span class="line">    // 方法1</span><br><span class="line">    &#x27;$route&#x27; (to, from) &#123;</span><br><span class="line">        // 监听路由是否变化</span><br><span class="line">        if(this.$route.params.articleId)&#123;</span><br><span class="line">            // 判断条件1  判断传递值的变化</span><br><span class="line">            //获取文章数据</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // 方法2</span><br><span class="line">    &#x27;$route&#x27;(to, from) &#123;</span><br><span class="line">        if (to.path == &quot;/page&quot;) &#123;</span><br><span class="line">            // 判断条件2  监听路由名 监听你从什么路由跳转过来的</span><br><span class="line">            this.message = this.$route.query.msg</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h2 id="异步回调函数中使用-this-无法指向-vue-实例对象"><a href="#异步回调函数中使用-this-无法指向-vue-实例对象" class="headerlink" title="异步回调函数中使用 this 无法指向 vue 实例对象"></a>异步回调函数中使用 this 无法指向 vue 实例对象</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// setTimeout/setInterval ajax Promise等等</span><br><span class="line">data()&#123;</span><br><span class="line">    return&#123; ... &#125;</span><br><span class="line">&#125;,</span><br><span class="line">methods ()&#123;  </span><br><span class="line">    setTimeout(function () &#123;  </span><br><span class="line">        // 其它几种情况相同console.log(this);</span><br><span class="line">        // 此时this指向并不是vue实例 导致操作的一些ma&#x27;f</span><br><span class="line">    &#125;,1000);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="解决方案-变量赋值和箭头函数"><a href="#解决方案-变量赋值和箭头函数" class="headerlink" title="解决方案 变量赋值和箭头函数"></a>解决方案 变量赋值和箭头函数</h3><h2 id="var-和-let-的区别"><a href="#var-和-let-的区别" class="headerlink" title="var 和 let 的区别"></a>var 和 let 的区别</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 使用变量访问this实例</span></span><br><span class="line"><span class="keyword">let</span> self = <span class="variable language_">this</span>;</span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(self);</span><br><span class="line">  <span class="comment">// 使用self变量访问this实例</span></span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="comment">// 箭头函数访问this实例 因为箭头函数本身没有绑定</span></span><br><span class="line"><span class="variable language_">this</span>.<span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>);</span><br><span class="line">&#125;, <span class="number">500</span>);</span><br></pre></td></tr></table></figure><h2 id="setInterval-路由跳转继续运行并没有及时进行销毁"><a href="#setInterval-路由跳转继续运行并没有及时进行销毁" class="headerlink" title="setInterval 路由跳转继续运行并没有及时进行销毁"></a>setInterval 路由跳转继续运行并没有及时进行销毁</h2><p>比如一些弹幕，走马灯文字，这类需要定时调用的，路由跳转之后，因为组件已经销毁了，但是 setInterval 还没有销毁，还在继续后台调用，控制台会不断报错，如果运算量大的话，无法及时清除，会导致严重的页面卡顿。</p><h3 id="解决办法：在组件生命周期-beforeDestroy-停止-setInterval"><a href="#解决办法：在组件生命周期-beforeDestroy-停止-setInterval" class="headerlink" title="解决办法：在组件生命周期 beforeDestroy 停止 setInterval"></a>解决办法：在组件生命周期 beforeDestroy 停止 setInterval</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 组件销毁前执行的钩子函数，跟其他生命周期钩子函数的用法相同。</span></span><br><span class="line"><span class="title function_">beforeDestroy</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">// 我通常是把setInterval()定时器赋值给this实例，然后就可以像下面这么停止。</span></span><br><span class="line">    <span class="built_in">clearInterval</span>(<span class="variable language_">this</span>.<span class="property">intervalId</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="vue-滚动行为用法-进入路由需要滚动到浏览器底部-头部等等"><a href="#vue-滚动行为用法-进入路由需要滚动到浏览器底部-头部等等" class="headerlink" title="vue 滚动行为用法,进入路由需要滚动到浏览器底部 头部等等"></a>vue 滚动行为用法,进入路由需要滚动到浏览器底部 头部等等</h2><p>使用前端路由，当切换到新路由时，想要页面滚到顶部，或者是保持原先的滚动位置，就像重新加载页面那样。 vue-router 能做到，而且更好，它让你可以自定义路由切换时页面如何滚动。</p><blockquote><p>注意: 这个功能只在支持 history.pushState 的浏览器中可用。</p></blockquote><h3 id="路由设置如下-详情猛戳"><a href="#路由设置如下-详情猛戳" class="headerlink" title="路由设置如下: 详情猛戳"></a>路由设置如下: 详情猛戳</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;  </span><br><span class="line">    <span class="attr">mode</span>: <span class="string">&#x27;history&#x27;</span>,</span><br><span class="line">    scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</span><br><span class="line">        <span class="keyword">if</span> (savedPosition) &#123;</span><br><span class="line">        <span class="comment">//如果savedPosition存在，滚动条会自动跳到记录的值的地方</span></span><br><span class="line">            <span class="keyword">return</span> savedPosition</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">x</span>: <span class="number">0</span>,</span><br><span class="line">                <span class="attr">y</span>: <span class="number">0</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// savedPosition也是一个记录x轴和y轴位置的对象</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;，</span><br><span class="line">    <span class="attr">routes</span>: [...]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="实现-vue-路由拦截浏览器的需求-进行一系列操作-草稿保存等等"><a href="#实现-vue-路由拦截浏览器的需求-进行一系列操作-草稿保存等等" class="headerlink" title="实现 vue 路由拦截浏览器的需求,进行一系列操作 草稿保存等等"></a>实现 vue 路由拦截浏览器的需求,进行一系列操作 草稿保存等等</h2><h3 id="场景："><a href="#场景：" class="headerlink" title="场景："></a>场景：</h3><p>为了防止用户失误点错关闭按钮等等，导致没有保存已输入的信息(关键信息)。</p><h3 id="用法："><a href="#用法：" class="headerlink" title="用法："></a>用法：</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在路由组件中：</span></span><br><span class="line"></span><br><span class="line">...</span><br><span class="line"></span><br><span class="line">beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</span><br><span class="line">    <span class="keyword">if</span>(用户已经输入信息)&#123;</span><br><span class="line">        <span class="comment">// 出现弹窗提醒保存草稿，或者自动后台为其保存</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;  </span><br><span class="line">        <span class="title function_">next</span>(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">// 用户离开</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>还有 beforeEach、beforeRouteUpdate 这些生命周期函数 详情猛戳</p><h2 id="v-once-只渲染元素和组件一次，优化更新渲染性能"><a href="#v-once-只渲染元素和组件一次，优化更新渲染性能" class="headerlink" title="v-once 只渲染元素和组件一次，优化更新渲染性能"></a>v-once 只渲染元素和组件一次，优化更新渲染性能</h2><p>v-once 这个指令相信大家用的很少,不过个人感觉还是挺实用的！</p><p>只渲染元素和组件一次。随后的重新渲染，元素/组件及其所有的子节点将被视为静态内容并跳过。这可以用于优化更新性能。</p><p>这个就不举例子了 直接猛戳这 v-once</p><h2 id="vue-本地代理配置-解决跨域问题-仅限于开发环境"><a href="#vue-本地代理配置-解决跨域问题-仅限于开发环境" class="headerlink" title="vue 本地代理配置 解决跨域问题,仅限于开发环境"></a>vue 本地代理配置 解决跨域问题,仅限于开发环境</h2><p>这个本地代理用来解决开发环境下的跨域问题,跨域可谓老生常谈的问题了,proxy 在 vue 中配置代理非常简单</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 比方说你要访问 http://192.168.1.xxx:8888/backEnd/paper 这个接口</span></span><br><span class="line"><span class="comment">// 配置 config.js 下面 proxyTable 对象</span></span><br><span class="line"><span class="attr">proxyTable</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;/backEnd&#x27;</span>:&#123;</span><br><span class="line">        <span class="attr">target</span>:<span class="string">&#x27;http://192.168.3.200:8888&#x27;</span>,</span><br><span class="line">        <span class="comment">// 目标接口域名有端口可以把端口也写上</span></span><br><span class="line">        <span class="comment">// 或者prot本地起服务端口与服务端统一</span></span><br><span class="line">        <span class="attr">changeOrigin</span>:<span class="literal">true</span>,</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,</span><br><span class="line"><span class="comment">// 发送request请求</span></span><br><span class="line">axios.<span class="title function_">get</span>(<span class="string">&#x27;/backEnd/page&#x27;</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123; <span class="comment">// 按代理配置 匹配到/backEnd就代理到目标target地址</span></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(res)</span><br><span class="line">    <span class="comment">// 数据完全拿得到  配置成功</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">newsList</span> = res.<span class="property">data</span></span><br><span class="line">&#125;, <span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(err)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="本地开发-没有任何问题-部署服务器-就-404-啊这些问题"><a href="#本地开发-没有任何问题-部署服务器-就-404-啊这些问题" class="headerlink" title="本地开发 没有任何问题 部署服务器 就 404 啊这些问题"></a>本地开发 没有任何问题 部署服务器 就 404 啊这些问题</h2><p>由于前端路由缘故，单页面应用应该放到 nginx 或者 apache、tomcat 等 web 代理服务器中，千万不要直接访问 index.html，同时要根据自己服务器的项目路径更改 react 或 vue 的路由地址</p><p><strong>注意点</strong></p><ol><li>vue-router 的 history 模式</li><li>服务 nginx 配置</li></ol><h2 id="Vuex-axios-发送请求"><a href="#Vuex-axios-发送请求" class="headerlink" title="Vuex + axios 发送请求"></a>Vuex + axios 发送请求</h2><p>安装其他插件的时候，可以直接在 main.js 中引入并 Vue.use()，但是 axios 并不能 use，只能每个需要发送请求的组件中即时引入<br>为了解决这个问题，有两种开发思路，一是在引入 axios 之后，修改原型链，二是结合 Vuex，封装一个 aciton。具体的实施请往下看~</p><h3 id="方案一：改写原型链"><a href="#方案一：改写原型链" class="headerlink" title="方案一：改写原型链"></a>方案一：改写原型链</h3><p>首先在 main.js 中引入 axios</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br></pre></td></tr></table></figure><p>这时候如果在其它的组件中，是无法使用 axios 命令的。但如果将 axios 改写为 Vue 的原型属性，就能解决这个问题</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$ajax</span> = axios;</span><br></pre></td></tr></table></figure><p>在 main.js 中添加了这两行代码之后，就能直接在组件的 methods 中使用 $ajax 命令</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">methods: &#123;</span><br><span class="line">  submitForm () &#123;</span><br><span class="line">    this.$ajax(&#123;</span><br><span class="line">      method: &#x27;post&#x27;,</span><br><span class="line">      url: &#x27;/user&#x27;,</span><br><span class="line">      data: &#123;</span><br><span class="line">        name: &#x27;wise&#x27;,</span><br><span class="line">        info: &#x27;wrong&#x27;</span><br><span class="line">      &#125;</span><br><span class="line">   &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="方案二：在-Vuex-中封装"><a href="#方案二：在-Vuex-中封装" class="headerlink" title="方案二：在 Vuex 中封装"></a>方案二：在 Vuex 中封装</h3><p>之前的文章中用到过 Vuex 的 mutations，从结果上看，mutations 类似于事件，用于提交 Vuex 中的状态 state<br>action 和 mutations 也很类似，主要的区别在于，action 可以包含异步操作，而且可以通过 action 来提交 mutations<br>另外还有一个重要的区别：<br>mutations 有一个固有参数 state，接收的是 Vuex 中的 state 对象<br>action 也有一个固有参数 context，但是 context 是 state 的父级，包含 state、getters</p><p>Vuex 的仓库是 store.js，将 axios 引入，并在 action 添加新的方法</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// store.js</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&quot;Vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&quot;vuex&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 引入 axios</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  <span class="comment">// 定义状态</span></span><br><span class="line">  <span class="attr">state</span>: &#123;</span><br><span class="line">    <span class="attr">test01</span>: &#123;</span><br><span class="line">      <span class="attr">name</span>: <span class="string">&quot;Wise Wrong&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">test02</span>: &#123;</span><br><span class="line">      <span class="attr">tell</span>: <span class="string">&quot;12312345678&quot;</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  <span class="attr">actions</span>: &#123;</span><br><span class="line">    <span class="comment">// 封装一个 ajax 方法</span></span><br><span class="line">    <span class="title function_">saveForm</span>(<span class="params">context</span>) &#123;</span><br><span class="line">      <span class="title function_">axios</span>(&#123;</span><br><span class="line">        <span class="attr">method</span>: <span class="string">&quot;post&quot;</span>,</span><br><span class="line">        <span class="attr">url</span>: <span class="string">&quot;/user&quot;</span>,</span><br><span class="line">        <span class="attr">data</span>: context.<span class="property">state</span>.<span class="property">test02</span></span><br><span class="line">      &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> store;</span><br></pre></td></tr></table></figure><blockquote><p>注意：即使已经在 main.js 中引入了 axios，并改写了原型链，也无法在 store.js 中直接使用 $ajax 命令<br>换言之，这两种方案是相互独立的</p></blockquote><p>参数可以通过调用的时候用变量传递</p><p>在组件中发送请求的时候，需要使用 this.$store.dispatch 来分发</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">  submitForm () &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="title function_">dispatch</span>(<span class="string">&#x27;saveForm&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>submitForm 是绑定在组件上的一个方法，将触发 saveForm，从而通过 axios 向服务器发送请求</p><h2 id="后续增加的-key-视图更新问题"><a href="#后续增加的-key-视图更新问题" class="headerlink" title="后续增加的 key 视图更新问题"></a>后续增加的 key 视图更新问题</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">    <span class="attr">data</span>:&#123;</span><br><span class="line">        <span class="attr">a</span>:<span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// `vm.a` 是响应的</span></span><br><span class="line">vm.<span class="property">b</span> = <span class="number">2</span></span><br><span class="line"><span class="comment">// `vm.b` 是非响应的</span></span><br><span class="line"><span class="comment">// 因为vm.b是后续新增的key</span></span><br></pre></td></tr></table></figure></div><div class="post-copyright"><div class="post-copyright-author"><span class="post-copyright-meta">本文作者: </span><span class="post-copyright-info"><a href="mailto:15757856604@163.com">吕钒</a></span></div><div class="post-copyright-type"><span class="post-copyright-meta">本文链接: </span><span class="post-copyright-info"><a href="https://lv-fan.gitee.io/lvfan/2018/06/11/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99-Vue-Vue%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%A2%B0%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/">https://lv-fan.gitee.io/lvfan/2018/06/11/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99-Vue-Vue%E4%BD%BF%E7%94%A8%E4%B8%AD%E7%A2%B0%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright-notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lv-fan.gitee.io/lvfan">吕钒的后花园</a>！</span></div></div><div class="post-copyright valine" id="comments-container"><script src="//unpkg.com/valine@1.4.14/dist/Valine.min.js"></script><script>let arr = location.href.split('/#more')[0].split('/');
let title = arr[arr.length - 1];
if (title === '') {
    title = arr[arr.length - 2];
}
var flag = false;
var gitFun = function () {
    try {
        var valineObj = window.GLOBAL_CONFIG.valine;
        new Valine({
            el: "#comments-container",
            ...valineObj
        });
        flag = true;
    } catch (e) {
        flag = false;
    }
}
var setIn = setInterval(() => {
    if (!flag) {
        gitFun();
    } else {
        clearInterval(setIn);
    }
}, 200);</script></div></article><div id="pagination"><div class="prev-post pull-left"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2018/06/11/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99-JavaScript-ES6%EF%BC%88ES2015%EF%BC%89%E6%A0%B8%E5%BF%83%E5%86%85%E5%AE%B9/"><i class="fas fa-angle-left">&nbsp;</i><span>ES6（ES2015）核心内容</span></a></div><div class="next-post pull-right"><span class="line line-top"></span><span class="line line-right"></span><span class="line line-bottom"></span><span class="line line-left"></span><a href="/2018/06/11/%E5%89%8D%E7%AB%AF%E8%B5%84%E6%96%99-Python-python%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"><span>python的一些常用操作</span><span>&nbsp;</span><i class="fas fa-angle-right"></i></a></div></div></div></div><div class="button-hover" id="return-top"><i class="fas fa-arrow-up" aria-hidden="true"></i></div><footer><div id="footer"><div class="button-hover" id="side-button"><i class="fas fa-arrow-right"></i></div><div class="right-content"><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fas fa-file-o"></i></span><span id="busuanzi_value_page_pv"></span><span></span></div><div class="copyright">&copy;2017 ～ 2023 By 吕钒</div></div></div></footer></div><script src="/js/thirdparty/jquery-3.3.1.min.js"></script><script src="/js/thirdparty/velocity.min.js"></script><script src="/js/thirdparty/jquery.mCustomScrollbar.concat.min.js"></script><script src="/js/fan.js"></script><script src="/js/canvas_bg.js"></script><script src="/js/utils.js"></script><script src="/js/scroll.js"></script><script src="/js/sidebar.js"></script><script src="/js/copy.js"></script><div class="search-dialog"><div id="algolia-search-title">Algolia</div><div class="search-close-button"><i class="fa fa-times"></i></div><div id="search-box"></div><hr><div id="hits"></div><div id="algolia-pagination"></div></div><div class="search-mask"></div><script src="/js/search/algolia.js"></script></body></html>